

renderer负责操作DOM的appendChild等API也是同步的，也就是说如果有大量节点需要更新，JS线程的运行时间可能会比较长，在这段时间浏览器是不会响应其他事件的，因为JS线程和GUI线程是互斥的，JS运行时页面就不会响应，这个时间太长了，用户就可能看到卡顿，特别是动画的卡顿会很明显。在React的官方演讲中有个例子，可以很明显的看到这种同步计算造成的卡顿.

1. 我们写的JSX代码被babel转化成了React.createElement。
2. React.createElement返回的其实就是虚拟DOM结构。
3. ReactDOM.render方法是将虚拟DOM渲染到页面的。
4. 虚拟DOM的调和和渲染可以简单粗暴的递归，但是这个过程是同步的，如果需要处理的节点过多，可能会阻塞用户输入和动画播放，造成卡顿。
5. Fiber是16.x引入的新特性，用处是将同步的调和变成异步的。
6. Fiber改造了虚拟DOM的结构，具有父 -> 第一个子，子 -> 兄，子 -> 父这几个指针，有了这几个指针，可以从任意一个Fiber节点找到其他节点。
7. Fiber将整棵树的同步任务拆分成了每个节点可以单独执行的异步执行结构。
8. Fiber可以从任意一个节点开始遍历，遍历是深度优先遍历，顺序是父 -> 子 -> 兄 -> 父，也就是从上往下，从左往右。
9. Fiber的调和阶段可以是异步的小任务，但是提交阶段(commit)必须是同步的。因为异步的commit可能让用户看到节点一个一个接连出现，体验不好。
10. 函数组件其实就是这个节点的type是个函数，直接将type拿来运行就可以得到虚拟DOM。
11. useState是在Fiber节点上添加了一个数组，数组里面的每个值对应了一个useState，useState调用顺序必须和这个数组下标匹配，不然会报错。